spring.application.name=MiniChatBackend
spring.datasource.url=jdbc:mysql://switchyard.proxy.rlwy.net:55642/railway
spring.datasource.username=root
spring.datasource.password=FEYSifyQcRNkUONNeEonsAXysJuwQeFL
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect

spring.devtools.restart.exclude=logs/**

## Logging configuration
#logging.level.com.miniapp.foodshare=INFO
#logging.level.com.miniapp.foodshare.security=INFO

# Spring framework logging - set to WARN to remove debug noise
#logging.level.org.springframework.web=WARN
#logging.level.org.springframework.security=WARN

# Logging pattern
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss}[%X{requestId:-}] [%-5level] [%logger{0}] - %msg%n

# Request/Response logging configuration
logging.request-response.enabled=true
logging.request-response.max-body-length=10000
logging.request-response.mask-sensitive-data=true
logging.request-response.log-headers=true
logging.request-response.log-bodies=true

# Swagger/OpenAPI configuration
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.swagger-ui.doc-expansion=none
springdoc.swagger-ui.enable-swagger-ui=true
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.default-produces-media-type=application/json
springdoc.default-consumes-media-type=application/json

spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=60000

# Cloudinary configuration
cloudinary.cloud-name=dlqkmnlgm
cloudinary.api-key=973758131154993
cloudinary.api-secret=ae9ExP4fUCUfMSgvH7ocy4ulXZ8
google.oauth.client-id=62641073672-3rjbtjt32kkng905ebr2nfebq3i18cl3.apps.googleusercontent.com

# Encryption configuration
app.encryption.secret-key=mySecretKey123456789012345678901234

# Facebook Graph API configuration (app-id, app-secret lấy từ Facebook Developer Console)
facebook.app-id=879601861469769
facebook.app-secret=94ee296a6e80fc60882ada1002d5f3b8
facebook.graph-api.url=https://graph.facebook.com/v24.0
facebook.oauth.token-exchange-path=/oauth/access_token
facebook.pages-endpoint=/me/accounts
facebook.pages-fields=id,name,picture,access_token
facebook.conversation.default-limit=25
facebook.conversation.max-limit=100
facebook.conversation.fields=id,link,message_count,participants,sender,updated_time
facebook.messages.fields=id,message,created_time,from
facebook.send-api.messaging-type=RESPONSE
facebook.user-profile.fields=name,picture.type(large)
facebook.platform-name=FACEBOOK
# Facebook Webhook (xác thực khi đăng ký webhook với Facebook)
facebook.webhook.verify-token=minichat_webhook_verify_token

# MongoDB (lưu tin nhắn từ webhook) - bật khi dùng, ví dụ:
spring.data.mongodb.uri=mongodb://mongo:dhSCkmpFfcxBLlCWCszCrvrTLmFtTMHq@mainline.proxy.rlwy.net:44069/minichat?authSource=admin

# Redis (Redisson dùng cho webhook queue). Trên Railway: nếu listener không start, kiểm tra (1) Service đã link Redis chưa, (2) Variables có ghi đè SPRING_DATA_REDIS_* không, (3) Log startup block "Webhook queue diagnostics" để xem RedissonClient=NO/YES.
spring.data.redis.host=yamanote.proxy.rlwy.net
spring.data.redis.port=44804
spring.data.redis.username=default
spring.data.redis.password=ONdqQOHnNATBtFHJdqalZHxnWWuaupdi
spring.data.redis.database=0
# Nếu Railway Redis plugin cung cấp REDIS_URL, có thể dùng: spring.data.redis.url=${REDIS_URL:}
# Không dùng Spring Data Redis Repository (chỉ dùng Redis/Redisson cho queue) → tránh cảnh báo "Could not safely identify store" với JPA/Mongo repo
spring.data.redis.repositories.enabled=false

# Webhook message queue (Delayed Queue -> Main Queue, Redis)
app.webhook.queue.producer-enabled=true
app.webhook.queue.listener-enabled=true
# Thời gian (giây) giữ tin trong delayed queue trước khi chuyển sang main queue
app.webhook.queue.delay-seconds=5
# Tên Redis key cho main queue (list) - listener lắng nghe queue này
app.webhook.queue.main-queue-name=minichat:message:main
# Mỗi cuộc hội thoại chỉ giữ N bản tin gần nhất (user + bot) trong Redis để dùng làm context
app.webhook.queue.conversation-max-messages=20
# Prefix key Redis lưu N tin gần nhất theo conversation: {prefix}{conversationId}
app.webhook.queue.conversation-recent-prefix=minichat:conv:recent:

# AI Core (xử lý tin nhắn chat)
app.ai-core.base-url=https://minichatai-production.up.railway.app
app.ai-core.chat-message-path=/api/chat/message